import{a as F,P as G,$ as X,a0 as f,d as J,e as O,R as u,a3 as Y,ao as Z,K as C,ap as ee,aq as re,ar as se,k as e,a4 as te,a5 as ae,n as z,G as V,q as x,U as _,X as M,C as K,F as c,T as l,M as A,A as le,m as b,x as ie,as as ne,ak as de,B as oe,y as Q,J as ce,at as ue,au as he,u as me,f as pe,av as xe,r as je,t as Se,S as fe}from"./index-62f20919.js";const ge=F(s=>({})),we=F({fileUploadButton:{marginTop:G(-32),marginLeft:G(128)}}),ye=X().shape({name:f().required("Supplier name is required"),email:f().email("Invalid email address").required("Supplier email is required"),mobile:f().required("Supplier mobile is required"),address:f().required("Supplier address is required"),city:f().required("Supplier city is required"),state:f().required("Supplier state is required"),country:f().required("Supplier country is required"),website:f().url().required("Supplier website is required")}),W=s=>{var B,D,I,o,y,T,P,U;const{opened:v,onClose:h,title:j,mode:t="add"}=s,{theme:q}=we(),g=J(),{state:{token:S}}=O(),[k,i]=u.useState(!1),r=Y({initialValues:{name:t==="edit"&&((B=s.record)==null?void 0:B.name)||"",email:t==="edit"&&((D=s.record)==null?void 0:D.email)||"",mobile:t==="edit"&&((I=s.record)==null?void 0:I.mobile)||"",address:t==="edit"&&((o=s.record)==null?void 0:o.address)||"",city:t==="edit"&&((y=s.record)==null?void 0:y.city)||"",state:t==="edit"&&((T=s.record)==null?void 0:T.state)||"",country:t==="edit"&&((P=s.record)==null?void 0:P.country)||"",website:t==="edit"&&((U=s.record)==null?void 0:U.website)||""},validationSchema:ye,onSubmit:(m,p)=>{console.log(m),t==="add"?n(m,p):E(m,p)}}),w=()=>{r.resetForm(),h()},n=(m,p)=>{i(a=>!0),g(Z({token:S,supplier:{...m,businessCard:"na",designation:"na",department:"na",customerId:"652506a266869aaf01825588"}})).unwrap().then(a=>{C("Add Supplier",a==null?void 0:a.message,a.success?"success":"error"),a.success&&(ee(a.data),p.resetForm(),h())}).catch(a=>{console.log("Add Supplier: ",a==null?void 0:a.message),C("Add Supplier","An error occurred","error")}).finally(()=>{i(a=>!1)})},E=(m,p)=>{var a;i(d=>!0),g(re({token:S,id:((a=s.record)==null?void 0:a._id)||"",supplier:{...m,businessCard:"na",designation:"na",department:"na",customerId:"652506a266869aaf01825588"}})).unwrap().then(d=>{C("Update Supplier",d==null?void 0:d.message,d.success?"success":"error"),d.success&&(g(se(d.data)),p.resetForm(),h())}).catch(d=>{console.log("Update Supplier: ",d==null?void 0:d.message),C("Update Supplier","An error occurred","error")}).finally(()=>{i(d=>!1)})};return u.useEffect(()=>{t==="edit"&&!s.record||r.setValues(m=>{var p,a,d,L,R,N,$,H;return{...m,name:t==="edit"&&((p=s.record)==null?void 0:p.name)||"",email:t==="edit"&&((a=s.record)==null?void 0:a.email)||"",mobile:t==="edit"&&((d=s.record)==null?void 0:d.mobile)||"",address:t==="edit"&&((L=s.record)==null?void 0:L.address)||"",city:t==="edit"&&((R=s.record)==null?void 0:R.city)||"",state:t==="edit"&&((N=s.record)==null?void 0:N.state)||"",country:t==="edit"&&(($=s.record)==null?void 0:$.country)||"",website:t==="edit"&&((H=s.record)==null?void 0:H.website)||""}})},[s.record,t]),e.jsx(te,{size:"xl",withinPortal:!0,withOverlay:!0,title:j,opened:v,onClose:h,overlayProps:ae(q),children:e.jsx(z,{children:e.jsx(V,{children:e.jsx(V.Col,{span:12,children:e.jsxs(z,{spacing:"xs",children:[e.jsx(x,{required:!0,withAsterisk:!1,label:"Name",name:"name",id:"name",value:r.values.name,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.name&&r.errors.name?r.errors.name:""}),e.jsxs(_,{grow:!0,align:"flex-start",children:[e.jsx(x,{required:!0,withAsterisk:!1,label:"Email",name:"email",id:"email",value:r.values.email,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.email&&r.errors.email?r.errors.email:""}),e.jsx(x,{required:!0,withAsterisk:!1,label:"Phone",name:"mobile",id:"mobile",value:r.values.mobile,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.mobile&&r.errors.mobile?r.errors.mobile:""})]}),e.jsx(x,{required:!0,withAsterisk:!1,label:"Address",name:"address",id:"address",value:r.values.address,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.address&&r.errors.address?r.errors.address:""}),e.jsxs(_,{grow:!0,align:"flex-start",children:[e.jsx(x,{required:!0,withAsterisk:!1,label:"City",name:"city",id:"city",value:r.values.city,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.city&&r.errors.city?r.errors.city:""}),e.jsx(x,{required:!0,withAsterisk:!1,label:"State",name:"state",id:"state",value:r.values.state,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.state&&r.errors.state?r.errors.state:""})]}),e.jsxs(_,{grow:!0,align:"flex-start",children:[e.jsx(x,{required:!0,withAsterisk:!1,label:"Country",name:"country",id:"country",value:r.values.country,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.country&&r.errors.country?r.errors.country:""}),e.jsx(x,{required:!0,withAsterisk:!1,label:"Website URL",placeholder:"https://www.example.com",name:"website",id:"website",value:r.values.website,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.website&&r.errors.website?r.errors.website:""})]}),e.jsxs(_,{align:"flex-end",position:"right",mt:G(32),children:[e.jsx(M,{variant:"outline",onClick:w,size:"xs",children:"Cancel"}),e.jsx(M,{size:"xs",variant:"filled",loading:k,onClick:()=>r.handleSubmit(),children:"Save"})]})]})})})})})},be=F(s=>({})),Ce=({item:s,setForEdit:v})=>{const{theme:h}=be(),j=J(),{state:{isAdmin:t,token:q}}=O(),[g,S]=u.useState(!1),k=w=>{ce({theme:h,title:"Delete Supplier",loading:g,description:e.jsx(l,{fw:"normal",fs:"normal",fz:"sm",color:b.titleText,children:"Are you sure you want to delete this supplier? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete Supplier",onConfirm:()=>{S(n=>!0),j(ue({token:q,id:w})).unwrap().then(n=>{C("Delete Supplier",n==null?void 0:n.message,n.success?"success":"error"),n.success&&j(he(w))}).catch(n=>{console.log("Delete Supplier: ",n==null?void 0:n.message),C("Delete Supplier","An error occurred","error")}).finally(()=>{S(n=>!1)})},onCancel:()=>C("Delete Supplier","Operation canceled!","error")})},i={fw:700,c:b.titleText,size:"sm"},r={fz:"sm",color:b.titleText};return e.jsx(K,{shadow:"md",m:"xs",children:e.jsxs(z,{spacing:"xs",children:[e.jsxs(c,{direction:"row",justify:"space-between",children:[e.jsxs(c,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(l,{...i,children:"Name: "}),e.jsx(l,{...r,children:s.name})]}),t?e.jsxs(A,{withArrow:!0,withinPortal:!0,children:[e.jsx(A.Target,{children:e.jsx(le,{color:b.titleText,children:e.jsx(ie,{})})}),e.jsxs(A.Dropdown,{children:[e.jsx(A.Label,{children:"Options"}),e.jsx(A.Item,{onClick:()=>v(s),icon:e.jsx(ne,{size:16}),color:b.titleText,children:"Edit"}),e.jsx(A.Item,{color:"red",icon:e.jsx(de,{size:16}),onClick:()=>k(s._id),children:"Delete"})]})]}):e.jsx(oe,{variant:"light",color:"red",children:e.jsx(l,{children:"Admin Required"})})]}),e.jsxs(c,{direction:"column",justify:"flex-start",m:0,p:0,children:[e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"Phone: "}),e.jsx(l,{...r,children:s.mobile})]}),e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"Email: "}),e.jsx(Q,{href:s.email,...r,color:"blue",children:s.email})]}),e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"City:"}),e.jsx(l,{...r,children:s.city})]}),e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"State: "}),e.jsx(l,{...r,children:s.state})]}),e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"Country: "}),e.jsx(l,{...r,children:s.state})]}),e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"Website: "}),e.jsx(Q,{href:s.website,...r,color:"blue",children:s.website})]}),e.jsxs(c,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(l,{...i,children:"Address: "}),e.jsx(l,{...r,children:s.address})]})]})]})},s._id)},Ae=()=>{ge();const{state:{isAdmin:s,isHR:v}}=O(),{classes:h}=me(),{data:j}=pe(xe),[t,q]=u.useState(""),[g,S]=u.useState(!1),[k,i]=u.useState(!1),[r,w]=u.useState([]),[n,E]=u.useState({}),B=u.useCallback(o=>{E(o),i(!0)},[]),D=o=>{if(q(o),s||v){const y=j.filter(T=>T.name.toLowerCase().includes(o.toLowerCase()));w(y)}};u.useEffect(()=>{w(j)},[s,v,j]);const I=r.length===0?e.jsx("center",{children:e.jsx(l,{color:b.titleText,align:"center",children:"No Suppliers"})}):e.jsx(e.Fragment,{children:r.map(o=>e.jsx(Ce,{item:o,setForEdit:B},o._id))});return e.jsx(K,{radius:"md",shadow:"md",h:"92vh",py:"xs",mb:"xs",children:e.jsxs(z,{children:[e.jsx(l,{fz:G(25),m:"xs",color:b.titleText,children:"Suppliers"}),e.jsxs(c,{gap:"md",m:"xs",className:h.searchContainer,children:[e.jsx(x,{value:t,className:h.searchInput,placeholder:"Search by any field",icon:e.jsx(je,{size:16}),onChange:o=>{var y;return D((y=o.target)==null?void 0:y.value)}}),s&&e.jsx(M,{variant:"filled",rightIcon:e.jsx(Se,{size:16}),onClick:()=>S(!0),children:"Supplier"})]}),e.jsx(fe,{type:"scroll",h:"72vh",children:I}),e.jsx(W,{mode:"add",title:"Add Supplier",record:void 0,opened:g,onClose:()=>S(!1)}),e.jsx(W,{mode:"edit",title:"Update Supplier",record:n,opened:k,onClose:()=>i(!1)})]})})};export{Ae as Suppliers,Ae as default};
