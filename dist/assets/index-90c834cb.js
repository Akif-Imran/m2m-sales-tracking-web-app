import{a as k,$ as D,a6 as G,a7 as M,d as E,e as z,R as d,ab as L,aL as U,V as y,aM as q,aN as N,aO as R,k as e,ac as $,ad as V,t as T,G as O,w as _,a0 as H,a3 as b,C as F,F as v,T as x,M as f,A as Q,l as p,I as J,aA as K,as as W,B as X,U as Y,aP as Z,aQ as ee,u as se,f as ae,aR as te,x as re,y as oe,S as ne}from"./index-95b3bade.js";const ce=k(t=>({})),ie=k({fileUploadButton:{marginTop:D(-32),marginLeft:D(128)}}),le=G().shape({name:M().required("Category name is required"),description:M().required("Category description is required")}),B=t=>{var w,A;const{opened:j,onClose:h,title:u,mode:c="add"}=t,{theme:S}=ie(),m=E(),{state:{token:g}}=z(),[P,l]=d.useState(!1),a=L({initialValues:{name:c==="edit"&&((w=t.record)==null?void 0:w.name)||"",description:c==="edit"&&((A=t.record)==null?void 0:A.description)||""},validationSchema:le,onSubmit:(i,r)=>{console.log(i),c==="add"?o(i,r):I(i,r)}}),C=()=>{a.resetForm(),h()},o=(i,r)=>{l(s=>!0),m(U({token:g,category:i})).unwrap().then(s=>{y("Add Purchase Category",s==null?void 0:s.message,s.success?"success":"error"),s.success&&(m(q(s.data)),r.resetForm(),h())}).catch(s=>{console.log("Add Purchase Category: ",s==null?void 0:s.message),y("Add Purchase Category","An error occurred","error")}).finally(()=>{l(s=>!1)})},I=(i,r)=>{var s;l(n=>!0),m(N({token:g,id:((s=t.record)==null?void 0:s._id)||"",category:i})).unwrap().then(n=>{y("Update Purchase Category",n==null?void 0:n.message,n.success?"success":"error"),n.success&&(m(R(n.data)),r.resetForm(),h())}).catch(n=>{console.log("Update Purchase Category: ",n==null?void 0:n.message),y("Update Purchase Category","An error occurred","error")}).finally(()=>{l(n=>!1)})};return d.useEffect(()=>{c==="edit"&&!t.record||a.setValues(i=>{var r,s;return{...i,name:c==="edit"&&((r=t.record)==null?void 0:r.name)||"",description:c==="edit"&&((s=t.record)==null?void 0:s.description)||""}})},[t.record,c]),e.jsx($,{size:"md",withinPortal:!0,withOverlay:!0,title:u,opened:j,onClose:h,overlayProps:V(S),children:e.jsx(T,{children:e.jsx(O,{children:e.jsx(O.Col,{span:12,children:e.jsxs(T,{spacing:"xs",children:[e.jsx(_,{required:!0,withAsterisk:!1,label:"Name",name:"name",id:"name",value:a.values.name,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.name&&a.errors.name?a.errors.name:""}),e.jsx(_,{required:!0,withAsterisk:!1,label:"Description",name:"description",id:"description",value:a.values.description,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.description&&a.errors.description?a.errors.description:""}),e.jsxs(H,{align:"flex-end",position:"right",mt:D(32),children:[e.jsx(b,{variant:"outline",onClick:C,size:"xs",children:"Cancel"}),e.jsx(b,{size:"xs",variant:"filled",loading:P,onClick:()=>a.handleSubmit(),children:"Save"})]})]})})})})})},de=k(t=>({})),he=({item:t,setForEdit:j})=>{const{theme:h}=de(),u=E(),{state:{isAdmin:c,token:S}}=z(),[m,g]=d.useState(!1),P=C=>{Y({theme:h,title:"Delete Purchase Category",loading:m,description:e.jsx(x,{fw:"normal",fs:"normal",fz:"sm",color:p.titleText,children:"Are you sure you want to delete this Purchase Category? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete",onConfirm:()=>{g(o=>!0),u(Z({token:S,id:C})).unwrap().then(o=>{y("Delete Purchase Category",o==null?void 0:o.message,o.success?"success":"error"),o.success&&u(ee(C))}).catch(o=>{console.log("Delete Purchase Category: ",o==null?void 0:o.message),y("Delete Purchase Category","An error occurred","error")}).finally(()=>{g(o=>!1)})},onCancel:()=>y("Delete Purchase Category","Operation canceled!","error")})},l={fw:700,c:p.titleText,size:"sm"},a={fz:"sm",color:p.titleText};return e.jsx(F,{shadow:"md",m:"xs",children:e.jsx(T,{spacing:"xs",children:e.jsxs(v,{direction:"row",justify:"space-between",children:[e.jsxs(v,{direction:"column",columnGap:"sm",children:[e.jsxs(v,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(x,{...l,children:"Name: "}),e.jsx(x,{...a,children:t.name})]}),e.jsxs(v,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(x,{...l,children:"Description: "}),e.jsx(x,{...a,children:t.description})]})]}),c?e.jsxs(f,{withArrow:!0,withinPortal:!0,children:[e.jsx(f.Target,{children:e.jsx(Q,{color:p.titleText,children:e.jsx(J,{})})}),e.jsxs(f.Dropdown,{children:[e.jsx(f.Label,{children:"Options"}),e.jsx(f.Item,{onClick:()=>j(t),icon:e.jsx(K,{size:16}),color:p.titleText,children:"Edit"}),e.jsx(f.Item,{color:"red",icon:e.jsx(W,{size:16}),onClick:()=>P(t._id),children:"Delete"})]})]}):e.jsx(X,{variant:"light",color:"red",children:e.jsx(x,{children:"Admin Required"})})]})})},t._id)},me=()=>{ce();const{state:{isAdmin:t,isHR:j}}=z(),{classes:h}=se(),{data:u}=ae(te),[c,S]=d.useState(""),[m,g]=d.useState(!1),[P,l]=d.useState(!1),[a,C]=d.useState([]),[o,I]=d.useState({}),w=d.useCallback(r=>{I(r),l(!0)},[]),A=r=>{if(S(r),t||j){const s=u.filter(n=>n.name.toLowerCase().includes(r.toLowerCase()));C(s)}};d.useEffect(()=>{C(u)},[t,j,u]);const i=a.length===0?e.jsx("center",{children:e.jsx(x,{color:p.titleText,align:"center",children:"No Purchase categories..."})}):e.jsx(e.Fragment,{children:a.map(r=>e.jsx(he,{item:r,setForEdit:w},r._id))});return e.jsx(F,{radius:"md",shadow:"md",h:"92vh",py:"xs",mb:"xs",children:e.jsxs(T,{children:[e.jsx(x,{fz:D(25),m:"xs",color:p.titleText,children:"Purchase Categories"}),e.jsxs(v,{gap:"md",m:"xs",className:h.searchContainer,children:[e.jsx(_,{value:c,className:h.searchInput,placeholder:"Search by any field",icon:e.jsx(re,{size:16}),onChange:r=>{var s;return A((s=r.target)==null?void 0:s.value)}}),t&&e.jsx(b,{variant:"filled",rightIcon:e.jsx(oe,{size:16}),onClick:()=>g(!0),children:"Category"})]}),e.jsx(ne,{type:"scroll",h:"72vh",children:i}),e.jsx(B,{mode:"add",title:"Add Category",record:void 0,opened:m,onClose:()=>g(!1)}),e.jsx(B,{mode:"edit",title:"Update Category",record:o,opened:P,onClose:()=>l(!1)})]})})};export{me as PurchaseCategories,me as default};
