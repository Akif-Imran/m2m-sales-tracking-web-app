import{c as k,o as D,ab as O,ac as M,d as F,e as z,R as h,ag as q,aY as L,X as j,aZ as U,a_ as N,a$ as P,j as e,ak as $,al as R,x as b,G as B,p as _,a5 as V,a8 as I,C as G,F as v,T as m,M as S,A as H,l as p,I as Q,aG as X,ax as Y,B as Z,V as J,b0 as K,b1 as ee,a as se,f as ae,b2 as te,q as oe,m as re,S as ne}from"./index-86d5aa19.js";const ce=k(o=>({})),ie=k({fileUploadButton:{marginTop:D(-32),marginLeft:D(128)}}),le=O().shape({name:M().required("Warehouse name is required"),description:M().required("Warehouse description is required")}),E=o=>{var y,A;const{opened:f,onClose:l,title:g,mode:i="add"}=o,{theme:w}=ie(),u=F(),{state:{token:x}}=z(),[W,d]=h.useState(!1),s=q({initialValues:{name:i==="edit"&&((y=o.record)==null?void 0:y.name)||"",description:i==="edit"&&((A=o.record)==null?void 0:A.description)||""},validationSchema:le,onSubmit:(t,n)=>{console.log(t),i==="add"?r(t,n):T(t,n)}}),C=()=>{s.resetForm(),l()},r=(t,n)=>{d(a=>!0),u(L({token:x,warehouse:t})).unwrap().then(a=>{j("Add Warehouse",a==null?void 0:a.message,a.success?"success":"error"),a.success&&(u(U(a.data)),n.resetForm(),l())}).catch(a=>{console.log("Add Warehouse: ",a==null?void 0:a.message),j("Add Warehouse","An error occurred","error")}).finally(()=>{d(a=>!1)})},T=(t,n)=>{var a;d(c=>!0),u(N({token:x,id:((a=o.record)==null?void 0:a._id)||"",warehouse:t})).unwrap().then(c=>{j("Update Warehouse",c==null?void 0:c.message,c.success?"success":"error"),c.success&&(u(P(c.data)),n.resetForm(),l())}).catch(c=>{console.log("Update Warehouse: ",c==null?void 0:c.message),j("Update Warehouse","An error occurred","error")}).finally(()=>{d(c=>!1)})};return h.useEffect(()=>{i==="edit"&&!o.record||s.setValues(t=>{var n,a;return{...t,name:i==="edit"&&((n=o.record)==null?void 0:n.name)||"",description:i==="edit"&&((a=o.record)==null?void 0:a.description)||""}})},[o.record,i]),e.jsx($,{size:"md",withinPortal:!0,withOverlay:!0,title:g,opened:f,onClose:l,overlayProps:R(w),children:e.jsx(b,{children:e.jsx(B,{children:e.jsx(B.Col,{span:12,children:e.jsxs(b,{spacing:"xs",children:[e.jsx(_,{required:!0,withAsterisk:!1,label:"Name",name:"name",id:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.name&&s.errors.name?s.errors.name:""}),e.jsx(_,{required:!0,withAsterisk:!1,label:"Description",name:"description",id:"description",value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.description&&s.errors.description?s.errors.description:""}),e.jsxs(V,{align:"flex-end",position:"right",mt:D(32),children:[e.jsx(I,{variant:"outline",onClick:C,size:"xs",children:"Cancel"}),e.jsx(I,{size:"xs",variant:"filled",loading:W,onClick:()=>s.handleSubmit(),children:"Save"})]})]})})})})})},de=k(o=>({})),he=({item:o,setForEdit:f})=>{const{theme:l}=de(),g=F(),{state:{isAdmin:i,token:w}}=z(),[u,x]=h.useState(!1),W=C=>{J({theme:l,title:"Delete Warehouse",loading:u,description:e.jsx(m,{fw:"normal",fs:"normal",fz:"sm",color:p.titleText,children:"Are you sure you want to delete this Warehouse? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete",onConfirm:()=>{x(r=>!0),g(K({token:w,id:C})).unwrap().then(r=>{j("Delete Warehouse",r==null?void 0:r.message,r.success?"success":"error"),r.success&&g(ee(C))}).catch(r=>{console.log("Delete Warehouse: ",r==null?void 0:r.message),j("Delete Warehouse","An error occurred","error")}).finally(()=>{x(r=>!1)})},onCancel:()=>j("Delete Warehouse","Operation canceled!","error")})},d={fw:700,c:p.titleText,size:"sm"},s={fz:"sm",color:p.titleText};return e.jsx(G,{shadow:"md",m:"xs",children:e.jsx(b,{spacing:"xs",children:e.jsxs(v,{direction:"row",justify:"space-between",children:[e.jsxs(v,{direction:"column",columnGap:"sm",children:[e.jsxs(v,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(m,{...d,children:"Name: "}),e.jsx(m,{...s,children:o.name})]}),e.jsxs(v,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(m,{...d,children:"Description: "}),e.jsx(m,{...s,children:o.description})]})]}),i?e.jsxs(S,{withArrow:!0,withinPortal:!0,children:[e.jsx(S.Target,{children:e.jsx(H,{color:p.titleText,children:e.jsx(Q,{})})}),e.jsxs(S.Dropdown,{children:[e.jsx(S.Label,{children:"Options"}),e.jsx(S.Item,{onClick:()=>f(o),icon:e.jsx(X,{size:16}),color:p.titleText,children:"Edit"}),e.jsx(S.Item,{color:"red",icon:e.jsx(Y,{size:16}),onClick:()=>W(o._id),children:"Delete"})]})]}):e.jsx(Z,{variant:"light",color:"red",children:e.jsx(m,{children:"Admin Required"})})]})})},o._id)},me=()=>{ce();const{state:{isAdmin:o}}=z(),{classes:f}=se(),{data:l}=ae(te),[g,i]=h.useState(""),[w,u]=h.useState(!1),[x,W]=h.useState(!1),[d,s]=h.useState([]),[C,r]=h.useState({}),T=h.useCallback(t=>{r(t),W(!0)},[]),y=t=>{i(t);const n=l.filter(a=>a.name.toLowerCase().includes(t.toLowerCase()));s(n)};h.useEffect(()=>{s(l)},[l]);const A=d.length===0?e.jsx("center",{children:e.jsx(m,{color:p.titleText,align:"center",children:"No Warehouses"})}):e.jsx(e.Fragment,{children:d.map(t=>e.jsx(he,{item:t,setForEdit:T},t._id))});return e.jsx(G,{radius:"md",shadow:"md",h:"92vh",py:"xs",mb:"xs",children:e.jsxs(b,{children:[e.jsx(m,{fz:D(25),m:"xs",color:p.titleText,children:"Warehouses"}),e.jsxs(v,{gap:"md",m:"xs",className:f.searchContainer,children:[e.jsx(_,{value:g,className:f.searchInput,placeholder:"Search by any field",icon:e.jsx(oe,{size:16}),onChange:t=>{var n;return y((n=t.target)==null?void 0:n.value)}}),o&&e.jsx(I,{variant:"filled",rightIcon:e.jsx(re,{size:16}),onClick:()=>u(!0),children:"Warehouse"})]}),e.jsx(ne,{type:"scroll",h:"72vh",children:A}),e.jsx(E,{mode:"add",title:"Add Warehouse",record:void 0,opened:w,onClose:()=>u(!1)}),e.jsx(E,{mode:"edit",title:"Update Warehouse",record:C,opened:x,onClose:()=>W(!1)})]})})};export{me as Warehouses,me as default};
