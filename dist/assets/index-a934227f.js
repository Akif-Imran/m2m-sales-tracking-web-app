import{c as Se,a as _e,u as De,b as Ae,d as Ie,e as be,f as y,s as Me,g as ve,h as Pe,i as Fe,j as Le,R as a,k as e,G as g,C as j,F as i,T as n,M as x,A as w,I as Q,l as h,m as Ge,n as I,o as Te,p as ke,S as b,B as W,q as B,r as ze,t as V,D as S,v as $,w as H,x as q,y as J,Q as Ne,z as K,E as Oe,H as Re,J as Ye,K as X,_ as Ee,L as Qe,N as We,O as Be,P as Ve,U as $e,V as M,W as He,X as qe}from"./index-4c56ab08.js";var Je=Se("trash-filled","IconTrashFilled",[["path",{d:"M20 6a1 1 0 0 1 .117 1.993l-.117 .007h-.081l-.919 11a3 3 0 0 1 -2.824 2.995l-.176 .005h-8c-1.598 0 -2.904 -1.249 -2.992 -2.75l-.005 -.167l-.923 -11.083h-.08a1 1 0 0 1 -.117 -1.993l.117 -.007h16z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}],["path",{d:"M14 2a2 2 0 0 1 2 2a1 1 0 0 1 -1.993 .117l-.007 -.117h-4l-.007 .117a1 1 0 0 1 -1.993 -.117a2 2 0 0 1 1.85 -1.995l.15 -.005h4z",fill:"currentColor",key:"svg-1",strokeWidth:"0"}]]);const Ke=_e(v=>({})),Ze=()=>{var E;const{theme:v}=Ke(),{classes:P}=De(),{companyId:m}=Ae();console.log(m);const F=Ie(),{state:{token:Z}}=be(),f=y(Me),_=y(ve),{projectStatus:U}=y(Pe),{data:L}=y(Fe),{data:D}=y(Le),[ee,G]=a.useState(!1),[se,ne]=a.useState(!0),[p,ie]=a.useState(),[re,te]=a.useState([]),[ce,T]=a.useState([]),[le,A]=a.useState([]),[l,k]=a.useState(),[ae,z]=a.useState(!1),[oe,N]=a.useState(!1),[de,O]=a.useState(!1),[xe,R]=a.useState(!1),[he,je]=a.useState(""),[me,Y]=a.useState(!1),[ue,pe]=a.useState("");a.useEffect(()=>{if(!m)return;const s=L.find(o=>o._id===m),r=_.filter(o=>o.customerId===m),d=D.filter(o=>o.customerId===m);T(d),te(r),ie(s),r.length>0&&(k(r[0]),A(f.filter(o=>o.projectId===r[0]._id))),ne(!1)},[m,L,_,D,f]);const ge=s=>{const r=_.find(o=>o._id===s);k(r);const d=f.filter(o=>o.projectId===s);A(d)},Ce=s=>{$e({theme:v,title:"Delete",loading:ee,description:e.jsx(n,{fw:"normal",fs:"normal",fz:"sm",color:h.titleText,children:"Are you sure you want to delete this Contact? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete",onConfirm:()=>ye(s),onCancel:()=>M("Delete","Operation canceled!","error")})},ye=s=>{G(r=>!0),F(He({token:Z,id:s})).unwrap().then(r=>{M("Delete Contact",r==null?void 0:r.message,r.success?"success":"error"),r.success&&F(qe(r.data._id))}).catch(r=>{console.log("Delete Contact: ",r==null?void 0:r.message),M("Delete Contact","An error occurred","error")}).finally(()=>{G(r=>!1)})},fe=s=>{je(s);const r=D.filter(d=>d.name.toLowerCase().includes(s.toLowerCase())&&d.customerId===m);T(r)},we=s=>{pe(s);const r=f.filter(d=>d.projectId===(l==null?void 0:l._id)).filter((d,o)=>{var C;return`${o+1}`.toLowerCase().includes(s.toLowerCase())||((C=d.contactPerson)==null?void 0:C.name.toLowerCase().includes(s.toLowerCase()))||d.meetingPlace.toLowerCase().includes(s.toLowerCase())});A(r)},t={fw:700,c:h.titleText,size:"sm"},c={fz:"sm",color:h.titleText},u={shadow:"sm",mb:"xs",px:"sm",py:"xs",radius:"md"};return se?e.jsx("div",{children:"Loading..."}):!p||!l?e.jsx("div",{children:"Nothing to see here..."}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsxs(g.Col,{span:3,children:[e.jsx(j,{...u,children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Leads/Projects List"}),e.jsxs(x,{withArrow:!0,withinPortal:!0,children:[e.jsx(x.Target,{children:e.jsx(w,{children:e.jsx(Q,{size:16,stroke:1.3,color:h.titleText})})}),e.jsxs(x.Dropdown,{children:[e.jsx(x.Label,{children:"New"}),e.jsx(x.Item,{color:h.titleText,icon:e.jsx(Ge,{...I}),onClick:()=>N(!0),children:"Project"}),e.jsx(x.Item,{color:h.titleText,icon:e.jsx(Te,{...I}),onClick:()=>O(!0),children:"Expense / Claim"}),e.jsx(x.Item,{color:h.titleText,icon:e.jsx(ke,{...I}),onClick:()=>R(!0),children:"Purchase Request"})]})]})]})}),e.jsx(b,{type:"scroll",h:"80vh",children:re.map(s=>{const r=U.find(d=>d.value===s.status.toString());return e.jsx(j,{shadow:"sm",mb:"xs",px:"sm",py:"xs",radius:"md",onClick:()=>ge(s._id),children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsxs(i,{direction:"column",align:"flex-start",children:[e.jsx(n,{...t,children:s.name}),e.jsx(W,{variant:"filled",color:B[s.status],children:r==null?void 0:r.label})]}),l._id===s._id&&e.jsx(ze,{size:24,color:h.titleText})]})},s._id)})})]}),e.jsx(g.Col,{span:9,children:e.jsxs(V,{spacing:"xs",children:[e.jsxs(g,{children:[e.jsxs(g.Col,{span:7,children:[e.jsx(j,{...u,children:e.jsx(V,{spacing:"xs",children:e.jsxs(i,{direction:"row",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Project Details"}),e.jsx(W,{ml:"lg",variant:"filled",color:B[l.status],children:l.statusName})]})})}),e.jsx(j,{...u,children:e.jsxs(i,{direction:"column",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Name: "}),e.jsx(n,{...c,children:l.name})]}),e.jsxs(i,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Type: "}),e.jsx(n,{...c,children:l.type})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Salesman: "}),e.jsx(n,{...c,children:(E=l.salesPersonValue)==null?void 0:E.name})]})]}),e.jsxs(i,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Value: "}),e.jsx(n,{...c,children:Intl.NumberFormat("en-US",{style:"currency",currency:l.value.currency,maximumFractionDigits:2,minimumFractionDigits:2}).format(l.value.amount)})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Contract Date: "}),e.jsx(n,{...c,children:S.fromISO(l.contractDate).toFormat($)})]})]}),e.jsxs(i,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Quotation: "}),e.jsx(n,{...c,children:l.quotation})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Delivery Date: "}),e.jsxs(n,{...c,children:[" ",S.fromISO(l.deliveryDate).toFormat($)]})]})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Description: "}),e.jsx(n,{...c,children:l.description})]})]})})]}),e.jsxs(g.Col,{span:5,children:[e.jsx(j,{...u,children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Contacts"}),e.jsxs(i,{direction:"row",columnGap:"xs",align:"center",children:[e.jsx(H,{size:"xs",radius:"md",value:he,className:P.searchInput,placeholder:"Search by any field",icon:e.jsx(q,{size:16}),onChange:s=>{var r;return fe((r=s.target)==null?void 0:r.value)}}),e.jsx(w,{variant:"filled",size:"sm",color:"dark",onClick:()=>z(!0),children:e.jsx(J,{size:16,stroke:1.3,color:h.white})})]})]})}),e.jsx(b,{type:"scroll",h:"36vh",children:ce.map(s=>e.jsx(j,{...u,children:e.jsx(a.Fragment,{children:e.jsxs(i,{direction:"row",justify:"flex-start",align:"flex-start",columnGap:"sm",children:[e.jsx(i,{my:"auto",children:e.jsx(Ne,{src:s.businessCard?`${K}\\${s.businessCard}`:"/user.png",children:e.jsx(Oe,{src:s.businessCard?`${K}\\${s.businessCard}`:"/user.png",size:88})},s._id)}),e.jsxs(i,{direction:"column",w:"100%",children:[e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Name:"}),e.jsx(n,{...c,children:(s==null?void 0:s.name)||"N/A"})]}),e.jsxs(x,{withinPortal:!0,withArrow:!0,position:"bottom-end",children:[e.jsx(x.Target,{children:e.jsx(w,{children:e.jsx(Q,{size:16,stroke:1.3,color:h.titleText})})}),e.jsxs(x.Dropdown,{children:[e.jsx(x.Label,{children:"Options"}),e.jsx(x.Item,{color:"red",icon:e.jsx(Je,{stroke:1.3,size:16}),onClick:()=>Ce(s._id),children:"Delete"})]})]})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Email:"}),e.jsx(Re,{...c,href:s==null?void 0:s.email,target:"_blank",c:"blue",children:(s==null?void 0:s.email)||"N/A"})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Mobile No.:"}),e.jsx(n,{...c,children:(s==null?void 0:s.mobile)||"N/A"})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Designation:"}),e.jsx(n,{...c,children:(s==null?void 0:s.designation)||"N/A"})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Department:"}),e.jsx(n,{...c,children:(s==null?void 0:s.department)||"N/A"})]})]})]})},s._id)}))})]})]}),e.jsxs("div",{children:[e.jsx(j,{...u,children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Meetings / Follow Up:"}),e.jsxs(i,{direction:"row",columnGap:"xs",align:"center",children:[e.jsx(H,{miw:"24vw",size:"xs",radius:"md",value:ue,className:P.searchInput,placeholder:"Search by contact, place, No.",icon:e.jsx(q,{size:16}),onChange:s=>{var r;return we((r=s.target)==null?void 0:r.value)}}),e.jsx(w,{variant:"filled",size:"sm",color:"dark",onClick:()=>Y(!0),children:e.jsx(J,{size:16,stroke:1.3,color:h.white})})]})]})}),e.jsx(b,{type:"scroll",h:"33vh",children:le.map((s,r)=>{var o,C;const d=s!=null&&s.expensePrice?Intl.NumberFormat("en-US",{style:"currency",currency:s.expensePrice.currency,maximumFractionDigits:2,minimumFractionDigits:2}).format(s.expensePrice.amount):"N/A";return Ye.createElement(j,{...u,key:s._id},e.jsx(a.Fragment,{children:e.jsxs(i,{direction:"row",justify:"space-between",children:[e.jsxs(i,{direction:"column",my:"md",children:[e.jsxs(n,{...t,mb:"xs",children:["#",r+1]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Date/Time: "}),e.jsx(n,{...c,children:S.fromISO(s.meetingDate).toFormat(X)})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Location:"}),e.jsx(n,{...c,children:s.meetingPlace})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Meeting With:"}),e.jsx(n,{...c,children:(o=s.contactPerson)==null?void 0:o.name})]}),e.jsxs(i,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...t,children:"Agenda:"}),e.jsx(n,{...c,children:s.meetingAgenda})]}),e.jsxs(i,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...t,children:"Summary:"}),e.jsx(n,{...c,children:s.meetingSummary})]})]}),e.jsxs(i,{direction:"column",my:"md",children:[e.jsx(n,{...t,mb:"xs",children:"Next Visit"}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Date/Time: "}),e.jsx(n,{...c,children:s.nextMeetingDate?S.fromISO(s.nextMeetingDate).toFormat(X):"---"})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Agenda:"}),e.jsx(n,{...c,children:s.nextMeetingAgenda})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Place:"}),e.jsx(n,{...c,children:s.nextMeetingPlace})]})]}),e.jsxs(i,{direction:"column",my:"md",children:[e.jsx(n,{...t,mb:"xs",children:"Expense / Claim"}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Name:"}),e.jsx(n,{...c,children:s==null?void 0:s.expenseName})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Type:"}),e.jsx(n,{...c,children:((C=s==null?void 0:s.expenseTypeDetail)==null?void 0:C.name)||"---"})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Price:"}),e.jsx(n,{...c,children:d})]})]})]})}))})})]})]})})]}),e.jsx(Ee,{title:"Add Lead/Project",opened:oe,onClose:()=>N(!1),companyId:p._id}),e.jsx(Qe,{title:"Add Contact",opened:ae,companyId:p._id,onClose:()=>z(!1)}),e.jsx(We,{title:"Add Follow Up",opened:me,projectId:l._id,companyId:p._id,onClose:()=>Y(!1)}),e.jsx(Be,{title:"Add Claim",opened:de,companyId:p._id,projectId:l._id,onClose:()=>O(!1)}),e.jsx(Ve,{title:"Add Purchase Request",opened:xe,companyId:p._id,projectId:l._id,onClose:()=>R(!1)})]})};export{Ze as CompanyProjects,Ze as default};
