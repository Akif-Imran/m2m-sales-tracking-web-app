import{a as k,$ as A,a6 as L,a7 as F,d as G,e as z,R as d,aa as U,aD as q,V as j,aE as N,aF as P,aG as R,k as e,ab as $,ac as H,t as D,G as M,w as _,a0 as V,a3 as b,C as O,F as S,T as m,M as E,A as Q,l as T,I as J,az as K,ar as W,B as X,U as Y,aH as Z,aI as ee,u as se,f as te,aJ as ne,x as ae,y as oe,S as re}from"./index-4c56ab08.js";const ce=k(n=>({})),ie=k({fileUploadButton:{marginTop:A(-32),marginLeft:A(128)}}),le=L().shape({name:F().required("Expense type name is required"),description:F().required("Expense type description is required")}),B=n=>{var v,w;const{opened:f,onClose:p,title:x,mode:c="add"}=n,{theme:g}=ie(),h=G(),{state:{token:u}}=z(),[C,l]=d.useState(!1),t=U({initialValues:{name:c==="edit"&&((v=n.record)==null?void 0:v.name)||"",description:c==="edit"&&((w=n.record)==null?void 0:w.description)||""},validationSchema:le,onSubmit:(i,a)=>{console.log(i),c==="add"?o(i,a):I(i,a)}}),y=()=>{t.resetForm(),p()},o=(i,a)=>{l(s=>!0),h(q({token:u,expenseType:i})).unwrap().then(s=>{j("Add Expense Type",s==null?void 0:s.message,s.success?"success":"error"),s.success&&(h(N(s.data)),a.resetForm(),p())}).catch(s=>{console.log("Add Expense Type: ",s==null?void 0:s.message),j("Add Expense Type","An error occurred","error")}).finally(()=>{l(s=>!1)})},I=(i,a)=>{var s;l(r=>!0),h(P({token:u,id:((s=n.record)==null?void 0:s._id)||"",expenseType:i})).unwrap().then(r=>{j("Update Expense Type",r==null?void 0:r.message,r.success?"success":"error"),r.success&&(h(R(r.data)),a.resetForm(),p())}).catch(r=>{console.log("Update Expense Type: ",r==null?void 0:r.message),j("Update Expense Type","An error occurred","error")}).finally(()=>{l(r=>!1)})};return d.useEffect(()=>{c==="edit"&&!n.record||t.setValues(i=>{var a,s;return{...i,name:c==="edit"&&((a=n.record)==null?void 0:a.name)||"",description:c==="edit"&&((s=n.record)==null?void 0:s.description)||""}})},[n.record,c]),e.jsx($,{size:"md",withinPortal:!0,withOverlay:!0,title:x,opened:f,onClose:p,overlayProps:H(g),children:e.jsx(D,{children:e.jsx(M,{children:e.jsx(M.Col,{span:12,children:e.jsxs(D,{spacing:"xs",children:[e.jsx(_,{required:!0,withAsterisk:!1,label:"Name",name:"name",id:"name",value:t.values.name,onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.name&&t.errors.name?t.errors.name:""}),e.jsx(_,{required:!0,withAsterisk:!1,label:"Description",name:"description",id:"description",value:t.values.description,onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.description&&t.errors.description?t.errors.description:""}),e.jsxs(V,{align:"flex-end",position:"right",mt:A(32),children:[e.jsx(b,{variant:"outline",onClick:y,size:"xs",children:"Cancel"}),e.jsx(b,{size:"xs",variant:"filled",loading:C,onClick:()=>t.handleSubmit(),children:"Save"})]})]})})})})})},de=k(n=>({})),pe=({item:n,setForEdit:f})=>{const{theme:p}=de(),x=G(),{state:{isAdmin:c,token:g}}=z(),[h,u]=d.useState(!1),C=y=>{Y({theme:p,title:"Delete Expense Type",loading:h,description:e.jsx(m,{fw:"normal",fs:"normal",fz:"sm",color:T.titleText,children:"Are you sure you want to delete this Expense Type? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete",onConfirm:()=>{u(o=>!0),x(Z({token:g,id:y})).unwrap().then(o=>{j("Delete Expense Type",o==null?void 0:o.message,o.success?"success":"error"),o.success&&x(ee(y))}).catch(o=>{console.log("Delete Expense Type: ",o==null?void 0:o.message),j("Delete Expense Type","An error occurred","error")}).finally(()=>{u(o=>!1)})},onCancel:()=>j("Delete Expense Type","Operation canceled!","error")})},l={fw:700,c:T.titleText,size:"sm"},t={fz:"sm",color:T.titleText};return e.jsx(O,{shadow:"md",m:"xs",children:e.jsx(D,{spacing:"xs",children:e.jsxs(S,{direction:"row",justify:"space-between",children:[e.jsxs(S,{direction:"column",columnGap:"sm",children:[e.jsxs(S,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(m,{...l,children:"Name: "}),e.jsx(m,{...t,children:n.name})]}),e.jsxs(S,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(m,{...l,children:"Description: "}),e.jsx(m,{...t,children:n.description})]})]}),c?e.jsxs(E,{withArrow:!0,withinPortal:!0,children:[e.jsx(E.Target,{children:e.jsx(Q,{color:T.titleText,children:e.jsx(J,{})})}),e.jsxs(E.Dropdown,{children:[e.jsx(E.Label,{children:"Options"}),e.jsx(E.Item,{onClick:()=>f(n),icon:e.jsx(K,{size:16}),color:T.titleText,children:"Edit"}),e.jsx(E.Item,{color:"red",icon:e.jsx(W,{size:16}),onClick:()=>C(n._id),children:"Delete"})]})]}):e.jsx(X,{variant:"light",color:"red",children:e.jsx(m,{children:"Admin Required"})})]})})},n._id)},he=()=>{ce();const{state:{isAdmin:n,isHR:f}}=z(),{classes:p}=se(),{data:x}=te(ne),[c,g]=d.useState(""),[h,u]=d.useState(!1),[C,l]=d.useState(!1),[t,y]=d.useState([]),[o,I]=d.useState({}),v=d.useCallback(a=>{I(a),l(!0)},[]),w=a=>{if(g(a),n||f){const s=x.filter(r=>r.name.toLowerCase().includes(a.toLowerCase()));y(s)}};d.useEffect(()=>{y(x)},[n,f,x]);const i=t.length===0?e.jsx("center",{children:e.jsx(m,{color:T.titleText,align:"center",children:"No Expense types..."})}):e.jsx(e.Fragment,{children:t.map(a=>e.jsx(pe,{item:a,setForEdit:v},a._id))});return e.jsx(O,{radius:"md",shadow:"md",h:"92vh",py:"xs",mb:"xs",children:e.jsxs(D,{children:[e.jsx(m,{fz:A(25),m:"xs",color:T.titleText,children:"Expense Types"}),e.jsxs(S,{gap:"md",m:"xs",className:p.searchContainer,children:[e.jsx(_,{value:c,className:p.searchInput,placeholder:"Search by any field",icon:e.jsx(ae,{size:16}),onChange:a=>{var s;return w((s=a.target)==null?void 0:s.value)}}),n&&e.jsx(b,{variant:"filled",rightIcon:e.jsx(oe,{size:16}),onClick:()=>u(!0),children:"Expense Type"})]}),e.jsx(re,{type:"scroll",h:"72vh",children:i}),e.jsx(B,{mode:"add",title:"Add Expense Type",record:void 0,opened:h,onClose:()=>u(!1)}),e.jsx(B,{mode:"edit",title:"Update Expense Type",record:o,opened:C,onClose:()=>l(!1)})]})})};export{he as ExpenseTypes,he as default};
