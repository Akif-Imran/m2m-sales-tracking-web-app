import{c as je,a as me,u as ue,b as pe,d as ge,e as fe,f as p,s as we,g as ye,h as Ce,i as Se,j as De,R as d,k as e,G as u,C as h,l as _e,T as n,S as D,F as r,B as O,p as R,I as be,m,n as _,D as b,o as E,q as Q,r as W,A as v,t as $,Q as ve,v as H,w as Ae,M as g,x as Ie,y as Fe,z as Le,E as ze,_ as Ge,H as Me,J as ke,K as A,L as Te,N as Ne}from"./index-62f20919.js";var Pe=je("trash-filled","IconTrashFilled",[["path",{d:"M20 6a1 1 0 0 1 .117 1.993l-.117 .007h-.081l-.919 11a3 3 0 0 1 -2.824 2.995l-.176 .005h-8c-1.598 0 -2.904 -1.249 -2.992 -2.75l-.005 -.167l-.923 -11.083h-.08a1 1 0 0 1 -.117 -1.993l.117 -.007h16z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}],["path",{d:"M14 2a2 2 0 0 1 2 2a1 1 0 0 1 -1.993 .117l-.007 -.117h-4l-.007 .117a1 1 0 0 1 -1.993 -.117a2 2 0 0 1 1.85 -1.995l.15 -.005h4z",fill:"currentColor",key:"svg-1",strokeWidth:"0"}]]);const Ye=me(I=>({})),Re=()=>{var P;const{theme:I}=Ye(),{classes:F}=ue(),{companyId:x}=pe();console.log(x);const L=ge(),{state:{token:B}}=fe(),f=p(we),w=p(ye),{projectStatus:V}=p(Ce),{data:z}=p(Se),{data:y}=p(De),[U,G]=d.useState(!1),[J,K]=d.useState(!0),[C,X]=d.useState(),[Z,q]=d.useState([]),[ee,M]=d.useState([]),[se,S]=d.useState([]),[c,k]=d.useState(),[ne,T]=d.useState(!1),[re,ie]=d.useState(""),[te,N]=d.useState(!1),[le,ce]=d.useState("");d.useEffect(()=>{if(!x)return;const s=z.find(a=>a._id===x),i=w.filter(a=>a.customerId===x),o=y.filter(a=>a.customerId===x);M(o),q(i),X(s),i.length>0&&(k(i[0]),S(f.filter(a=>a.projectId===i[0]._id))),K(!1)},[x,z,w,y,f]);const ae=s=>{const i=w.find(a=>a._id===s);k(i);const o=f.filter(a=>a.projectId===s);S(o)},oe=s=>{ke({theme:I,title:"Delete",loading:U,description:e.jsx(n,{fw:"normal",fs:"normal",fz:"sm",color:m.titleText,children:"Are you sure you want to delete this Contact? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete",onConfirm:()=>de(s),onCancel:()=>A("Delete","Operation canceled!","error")})},de=s=>{G(i=>!0),L(Te({token:B,id:s})).unwrap().then(i=>{A("Delete Contact",i==null?void 0:i.message,i.success?"success":"error"),i.success&&L(Ne(i.data._id))}).catch(i=>{console.log("Delete Contact: ",i==null?void 0:i.message),A("Delete Contact","An error occurred","error")}).finally(()=>{G(i=>!1)})},he=s=>{ie(s);const i=y.filter(o=>o.name.toLowerCase().includes(s.toLowerCase())&&o.customerId===x);M(i)},xe=s=>{ce(s);const i=f.filter(o=>o.projectId===(c==null?void 0:c._id)).filter((o,a)=>{var Y;return`${a+1}`.toLowerCase().includes(s.toLowerCase())||((Y=o.contactPerson)==null?void 0:Y.name.toLowerCase().includes(s.toLowerCase()))||o.meetingPlace.toLowerCase().includes(s.toLowerCase())});S(i)},t={fw:700,c:m.titleText,size:"sm"},l={fz:"sm",color:m.titleText},j={shadow:"sm",mb:"xs",px:"sm",py:"xs",radius:"md"};return J?e.jsx("div",{children:"Loading..."}):!C||!c?e.jsx("div",{children:"Nothing to see here..."}):e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsxs(u.Col,{span:3,children:[e.jsx(h,{...j,children:e.jsx(_e,{children:e.jsx(n,{...t,size:"lg",children:"Leads/Projects List"})})}),e.jsx(D,{type:"scroll",h:"80vh",children:Z.map(s=>{const i=V.find(o=>o.value===s.status.toString());return e.jsx(h,{shadow:"sm",mb:"xs",px:"sm",py:"xs",radius:"md",onClick:()=>ae(s._id),children:e.jsxs(r,{direction:"row",justify:"space-between",align:"center",children:[e.jsxs(r,{direction:"column",children:[e.jsx(n,{...t,children:s.name}),e.jsx(O,{variant:"filled",color:R[s.status],children:i==null?void 0:i.label})]}),c._id===s._id&&e.jsx(be,{size:24,color:m.titleText})]})},s._id)})})]}),e.jsx(u.Col,{span:9,children:e.jsxs(_,{spacing:"xs",children:[e.jsxs(u,{children:[e.jsxs(u.Col,{span:7,children:[e.jsx(h,{...j,children:e.jsx(_,{spacing:"xs",children:e.jsxs(r,{direction:"row",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Project Details"}),e.jsx(O,{ml:"lg",variant:"filled",color:R[c.status],children:c.statusName})]})})}),e.jsx(h,{...j,children:e.jsxs(_,{children:[e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Name: "}),e.jsx(n,{...l,children:c.name})]}),e.jsxs(r,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Type: "}),e.jsx(n,{...l,children:c.type})]}),e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Salesman: "}),e.jsx(n,{...l,children:(P=c.salesPersonValue)==null?void 0:P.name})]})]}),e.jsxs(r,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Value: "}),e.jsx(n,{...l,children:Intl.NumberFormat("en-US",{style:"currency",currency:c.value.currency,maximumFractionDigits:2,minimumFractionDigits:2}).format(c.value.amount)})]}),e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Contract Date: "}),e.jsx(n,{...l,children:b.fromISO(c.contractDate).toFormat(E)})]})]}),e.jsxs(r,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Quotation: "}),e.jsx(n,{...l,children:c.quotation})]}),e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Delivery Date: "}),e.jsxs(n,{...l,children:[" ",b.fromISO(c.deliveryDate).toFormat(E)]})]})]}),e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Description: "}),e.jsx(n,{...l,children:c.description})]})]})})]}),e.jsxs(u.Col,{span:5,children:[e.jsx(h,{...j,children:e.jsxs(r,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Contacts"}),e.jsxs(r,{direction:"row",columnGap:"xs",align:"center",children:[e.jsx(Q,{size:"xs",radius:"md",value:re,className:F.searchInput,placeholder:"Search by any field",icon:e.jsx(W,{size:16}),onChange:s=>{var i;return he((i=s.target)==null?void 0:i.value)}}),e.jsx(v,{variant:"filled",size:"sm",color:"dark",onClick:()=>T(!0),children:e.jsx($,{size:16,stroke:1.3,color:m.white})})]})]})}),e.jsx(D,{type:"scroll",h:"36vh",children:ee.map(s=>e.jsx(h,{...j,children:e.jsx(d.Fragment,{children:e.jsxs(r,{direction:"row",justify:"flex-start",align:"flex-start",columnGap:"sm",children:[e.jsx(r,{my:"auto",children:e.jsx(ve,{src:s.businessCard?`${H}\\${s.businessCard}`:"/user.png",children:e.jsx(Ae,{src:s.businessCard?`${H}\\${s.businessCard}`:"/user.png",size:88})},s._id)}),e.jsxs(r,{direction:"column",w:"100%",children:[e.jsxs(r,{direction:"row",justify:"space-between",align:"center",children:[e.jsxs(r,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Name:"}),e.jsx(n,{...l,children:(s==null?void 0:s.name)||"N/A"})]}),e.jsxs(g,{withinPortal:!0,withArrow:!0,position:"bottom-end",children:[e.jsx(g.Target,{children:e.jsx(v,{children:e.jsx(Ie,{size:16,stroke:1.3,color:m.titleText})})}),e.jsxs(g.Dropdown,{children:[e.jsx(g.Label,{children:"Options"}),e.jsx(g.Item,{color:"red",icon:e.jsx(Pe,{stroke:1.3,size:16}),onClick:()=>oe(s._id),children:"Delete"})]})]})]}),e.jsxs(r,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Email:"}),e.jsx(Fe,{...l,href:s==null?void 0:s.email,target:"_blank",c:"blue",children:(s==null?void 0:s.email)||"N/A"})]}),e.jsxs(r,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Mobile No.:"}),e.jsx(n,{...l,children:(s==null?void 0:s.mobile)||"N/A"})]}),e.jsxs(r,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Designation:"}),e.jsx(n,{...l,children:(s==null?void 0:s.designation)||"N/A"})]}),e.jsxs(r,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...t,mr:"xs",children:"Department:"}),e.jsx(n,{...l,children:(s==null?void 0:s.department)||"N/A"})]})]})]})},s._id)}))})]})]}),e.jsxs("div",{children:[e.jsx(h,{...j,children:e.jsxs(r,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...t,size:"lg",children:"Meetings / Follow Up:"}),e.jsxs(r,{direction:"row",columnGap:"xs",align:"center",children:[e.jsx(Q,{miw:"24vw",size:"xs",radius:"md",value:le,className:F.searchInput,placeholder:"Search by contact, place, No.",icon:e.jsx(W,{size:16}),onChange:s=>{var i;return xe((i=s.target)==null?void 0:i.value)}}),e.jsx(v,{variant:"filled",size:"sm",color:"dark",onClick:()=>N(!0),children:e.jsx($,{size:16,stroke:1.3,color:m.white})})]})]})}),e.jsx(D,{type:"scroll",h:"33vh",children:se.map((s,i)=>{var a;const o=s!=null&&s.expensePrice?Intl.NumberFormat("en-US",{style:"currency",currency:s.expensePrice.currency,maximumFractionDigits:2,minimumFractionDigits:2}).format(s.expensePrice.amount):"N/A";return Le.createElement(h,{...j,key:s._id},e.jsx(d.Fragment,{children:e.jsxs(r,{direction:"column",my:"md",children:[e.jsxs(n,{...t,mb:"sm",children:["#",i+1]}),e.jsxs(r,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Date/Time: "}),e.jsxs(n,{...l,children:[" ",b.fromISO(s.meetingDate).toFormat(ze)]})]}),e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Location:"}),e.jsx(n,{...l,children:s.meetingPlace})]}),e.jsxs(r,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...t,children:"Meeting With:"}),e.jsx(n,{...l,children:(a=s.contactPerson)==null?void 0:a.name})]})]}),e.jsx(r,{direction:"row",align:"center",justify:"space-between",children:e.jsxs(r,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...t,children:"Agenda:"}),e.jsx(n,{...l,children:s.meetingAgenda})]})}),e.jsx(r,{direction:"row",align:"center",justify:"space-between",children:e.jsxs(r,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...t,children:"Summary:"}),e.jsx(n,{...l,children:s.meetingSummary})]})}),e.jsx(r,{direction:"row",align:"center",justify:"space-between",children:e.jsxs(r,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...t,children:"Total Expense:"}),e.jsx(n,{...l,children:o})]})})]})}))})})]})]})})]}),e.jsx(Ge,{title:"Add Contact",opened:ne,companyId:C._id,onClose:()=>T(!1)}),e.jsx(Me,{title:"Add Follow Up",opened:te,projectId:c._id,companyId:C._id,onClose:()=>N(!1)})]})};export{Re as CompanyProjects,Re as default};
