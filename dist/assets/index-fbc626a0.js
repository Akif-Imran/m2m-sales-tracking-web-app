import{c as _e,a as De,u as Ae,b as Ie,d as be,e as Me,f as y,s as Pe,g as Le,h as ve,i as Fe,j as Ge,R as a,k as e,G as g,C as m,F as i,T as n,M as x,A as w,I as B,l as h,m as Te,n as M,o as ke,p as ze,S as P,B as V,q as $,r as Ne,t as H,D as S,v as q,w as J,x as K,y as X,Q as Oe,z as Z,E as Re,H as Ye,J as Ee,K as U,_ as We,L as Qe,N as Be,O as Ve,P as $e,U as He,V as L,W as qe,X as Je}from"./index-95b3bade.js";var Ke=_e("trash-filled","IconTrashFilled",[["path",{d:"M20 6a1 1 0 0 1 .117 1.993l-.117 .007h-.081l-.919 11a3 3 0 0 1 -2.824 2.995l-.176 .005h-8c-1.598 0 -2.904 -1.249 -2.992 -2.75l-.005 -.167l-.923 -11.083h-.08a1 1 0 0 1 -.117 -1.993l.117 -.007h16z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}],["path",{d:"M14 2a2 2 0 0 1 2 2a1 1 0 0 1 -1.993 .117l-.007 -.117h-4l-.007 .117a1 1 0 0 1 -1.993 -.117a2 2 0 0 1 1.85 -1.995l.15 -.005h4z",fill:"currentColor",key:"svg-1",strokeWidth:"0"}]]);const Xe=De(v=>({})),Ue=()=>{var Q;const{theme:v}=Xe(),{classes:F}=Ae(),{companyId:j}=Ie();console.log(j);const G=be(),{state:{token:ee,user:_}}=Me(),f=y(Pe),D=y(Le),A=y(ve),{data:T}=y(Fe),{data:I}=y(Ge),[se,k]=a.useState(!1),[ne,ie]=a.useState(!0),[p,re]=a.useState(),[te,ce]=a.useState([]),[le,z]=a.useState([]),[ae,b]=a.useState([]),[l,N]=a.useState(),[oe,O]=a.useState(!1),[de,R]=a.useState(!1),[xe,Y]=a.useState(!1),[he,E]=a.useState(!1),[me,je]=a.useState(""),[ue,W]=a.useState(!1),[pe,ge]=a.useState("");a.useEffect(()=>{if(!j)return;const s=T.find(o=>o._id===j),t=D.concat(A).filter(o=>o.customerId===j),d=I.filter(o=>o.customerId===j);z(d),ce(t),re(s),t.length>0&&(N(t[0]),b(f.filter(o=>o.projectId===t[0]._id))),ie(!1)},[j,T,D,I,f,A]);const Ce=s=>{const t=D.concat(A).find(o=>o._id===s);N(t);const d=f.filter(o=>o.projectId===s);b(d)},ye=s=>{He({theme:v,title:"Delete",loading:se,description:e.jsx(n,{fw:"normal",fs:"normal",fz:"sm",color:h.titleText,children:"Are you sure you want to delete this Contact Person? This action is destructive and you will have to contact support to restore data."}),cancelLabel:"Cancel",confirmLabel:"Delete",onConfirm:()=>fe(s),onCancel:()=>L("Delete","Operation canceled!","error")})},fe=s=>{k(t=>!0),G(qe({token:ee,id:s})).unwrap().then(t=>{L("Delete Contact",t==null?void 0:t.message,t.success?"success":"error"),t.success&&G(Je(t.data._id))}).catch(t=>{console.log("Delete Contact: ",t==null?void 0:t.message),L("Delete Contact","An error occurred","error")}).finally(()=>{k(t=>!1)})},we=s=>{je(s);const t=I.filter(d=>d.name.toLowerCase().includes(s.toLowerCase())&&d.customerId===j);z(t)},Se=s=>{ge(s);const t=f.filter(d=>d.projectId===(l==null?void 0:l._id)).filter((d,o)=>{var C;return`${o+1}`.toLowerCase().includes(s.toLowerCase())||((C=d.contactPerson)==null?void 0:C.name.toLowerCase().includes(s.toLowerCase()))||d.meetingPlace.toLowerCase().includes(s.toLowerCase())});b(t)},r={fw:700,c:h.titleText,size:"sm"},c={fz:"sm",color:h.titleText},u={shadow:"sm",mb:"xs",px:"sm",py:"xs",radius:"md"};return ne?e.jsx("div",{children:"Loading..."}):!p||!l?e.jsx("center",{children:"Nothing to see here..."}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsxs(g.Col,{span:3,children:[e.jsx(m,{...u,children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...r,size:"lg",children:"Leads/Projects List"}),e.jsxs(x,{withArrow:!0,withinPortal:!0,children:[e.jsx(x.Target,{children:e.jsx(w,{children:e.jsx(B,{size:16,stroke:1.3,color:h.titleText})})}),e.jsxs(x.Dropdown,{children:[e.jsx(x.Label,{children:"New"}),e.jsx(x.Item,{color:h.titleText,icon:e.jsx(Te,{...M}),onClick:()=>R(!0),children:"Prospect"}),e.jsx(x.Item,{color:h.titleText,icon:e.jsx(ke,{...M}),onClick:()=>Y(!0),children:"Expense / Claim"}),e.jsx(x.Item,{color:h.titleText,icon:e.jsx(ze,{...M}),onClick:()=>E(!0),children:"Purchase Request"})]})]})]})}),e.jsx(P,{type:"scroll",h:"80vh",children:te.map(s=>e.jsx(m,{shadow:"sm",mb:"xs",px:"sm",py:"xs",radius:"md",onClick:()=>Ce(s._id),children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsxs(i,{direction:"column",align:"flex-start",children:[e.jsx(n,{...r,children:s.name}),e.jsx(V,{variant:"filled",color:$[s.status],children:s==null?void 0:s.statusName})]}),l._id===s._id&&e.jsx(Ne,{size:24,color:h.titleText})]})},s._id))})]}),e.jsx(g.Col,{span:9,children:e.jsxs(H,{spacing:"xs",children:[e.jsxs(g,{children:[e.jsxs(g.Col,{span:7,children:[e.jsx(m,{...u,children:e.jsx(H,{spacing:"xs",children:e.jsxs(i,{direction:"row",align:"center",children:[e.jsx(n,{...r,size:"lg",children:"Details"}),e.jsx(V,{ml:"lg",variant:"filled",color:$[l.status],children:l.statusName})]})})}),e.jsx(m,{...u,children:e.jsxs(i,{direction:"column",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Name: "}),e.jsx(n,{...c,children:l.name})]}),e.jsxs(i,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Type: "}),e.jsx(n,{...c,children:l.type})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Salesman: "}),e.jsx(n,{...c,children:l.salesPerson===(_==null?void 0:_._id)?"(You)":(Q=l.salesPersonValue)==null?void 0:Q.name})]})]}),e.jsxs(i,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Value: "}),e.jsx(n,{...c,children:Intl.NumberFormat("en-US",{style:"currency",currency:l.value.currency,maximumFractionDigits:2,minimumFractionDigits:2}).format(l.value.amount)})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Contract Date: "}),e.jsx(n,{...c,children:S.fromISO(l.contractDate).toFormat(q)})]})]}),e.jsxs(i,{direction:"row",align:"center",justify:"space-between",children:[e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Quotation: "}),e.jsx(n,{...c,children:l.quotation})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Delivery Date: "}),e.jsxs(n,{...c,children:[" ",S.fromISO(l.deliveryDate).toFormat(q)]})]})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Description: "}),e.jsx(n,{...c,children:l.description})]})]})})]}),e.jsxs(g.Col,{span:5,children:[e.jsx(m,{...u,children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...r,size:"lg",children:"Contact Persons"}),e.jsxs(i,{direction:"row",columnGap:"xs",align:"center",children:[e.jsx(J,{size:"xs",radius:"md",value:me,className:F.searchInput,placeholder:"Search by any field",icon:e.jsx(K,{size:16}),onChange:s=>{var t;return we((t=s.target)==null?void 0:t.value)}}),e.jsx(w,{variant:"filled",size:"sm",color:"dark",onClick:()=>O(!0),children:e.jsx(X,{size:16,stroke:1.3,color:h.white})})]})]})}),e.jsx(P,{type:"scroll",h:"36vh",children:le.map(s=>e.jsx(m,{...u,children:e.jsx(a.Fragment,{children:e.jsxs(i,{direction:"row",justify:"flex-start",align:"flex-start",columnGap:"sm",children:[e.jsx(i,{my:"auto",children:e.jsx(Oe,{src:s.businessCard?`${Z}\\${s.businessCard}`:"/user.png",children:e.jsx(Re,{src:s.businessCard?`${Z}\\${s.businessCard}`:"/user.png",size:88})},s._id)}),e.jsxs(i,{direction:"column",w:"100%",children:[e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...r,mr:"xs",children:"Name:"}),e.jsx(n,{...c,children:(s==null?void 0:s.name)||"N/A"})]}),e.jsxs(x,{withinPortal:!0,withArrow:!0,position:"bottom-end",children:[e.jsx(x.Target,{children:e.jsx(w,{children:e.jsx(B,{size:16,stroke:1.3,color:h.titleText})})}),e.jsxs(x.Dropdown,{children:[e.jsx(x.Label,{children:"Options"}),e.jsx(x.Item,{color:"red",icon:e.jsx(Ke,{stroke:1.3,size:16}),onClick:()=>ye(s._id),children:"Delete"})]})]})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...r,mr:"xs",children:"Email:"}),e.jsx(Ye,{...c,href:s==null?void 0:s.email,target:"_blank",c:"blue",children:(s==null?void 0:s.email)||"N/A"})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...r,mr:"xs",children:"Mobile No.:"}),e.jsx(n,{...c,children:(s==null?void 0:s.mobile)||"N/A"})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...r,mr:"xs",children:"Designation:"}),e.jsx(n,{...c,children:(s==null?void 0:s.designation)||"N/A"})]}),e.jsxs(i,{direction:"row",align:"center",justify:"flex-start",children:[e.jsx(n,{...r,mr:"xs",children:"Department:"}),e.jsx(n,{...c,children:(s==null?void 0:s.department)||"N/A"})]})]})]})},s._id)}))})]})]}),e.jsxs("div",{children:[e.jsx(m,{...u,children:e.jsxs(i,{direction:"row",justify:"space-between",align:"center",children:[e.jsx(n,{...r,size:"lg",children:"Meetings / Follow Up:"}),e.jsxs(i,{direction:"row",columnGap:"xs",align:"center",children:[e.jsx(J,{miw:"24vw",size:"xs",radius:"md",value:pe,className:F.searchInput,placeholder:"Search by contact, place, No.",icon:e.jsx(K,{size:16}),onChange:s=>{var t;return Se((t=s.target)==null?void 0:t.value)}}),e.jsx(w,{variant:"filled",size:"sm",color:"dark",onClick:()=>W(!0),children:e.jsx(X,{size:16,stroke:1.3,color:h.white})})]})]})}),e.jsx(P,{type:"scroll",h:"33vh",children:ae.map((s,t)=>{var o,C;const d=s!=null&&s.expensePrice?Intl.NumberFormat("en-US",{style:"currency",currency:s.expensePrice.currency,maximumFractionDigits:2,minimumFractionDigits:2}).format(s.expensePrice.amount):"N/A";return Ee.createElement(m,{...u,key:s._id},e.jsx(a.Fragment,{children:e.jsxs(i,{direction:"row",justify:"space-between",children:[e.jsxs(i,{direction:"column",my:"md",children:[e.jsxs(n,{...r,mb:"xs",children:["#",t+1]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Date/Time: "}),e.jsx(n,{...c,children:S.fromISO(s.meetingDate).toFormat(U)})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Location:"}),e.jsx(n,{...c,children:s.meetingPlace})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Meeting With:"}),e.jsx(n,{...c,children:(o=s.contactPerson)==null?void 0:o.name})]}),e.jsxs(i,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...r,children:"Agenda:"}),e.jsx(n,{...c,children:s.meetingAgenda})]}),e.jsxs(i,{direction:"row",align:"flex-start",columnGap:"sm",children:[e.jsx(n,{...r,children:"Summary:"}),e.jsx(n,{...c,children:s.meetingSummary})]})]}),e.jsxs(i,{direction:"column",my:"md",children:[e.jsx(n,{...r,mb:"xs",children:"Next Visit"}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Date/Time: "}),e.jsx(n,{...c,children:s.nextMeetingDate?S.fromISO(s.nextMeetingDate).toFormat(U):"---"})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Agenda:"}),e.jsx(n,{...c,children:s.nextMeetingAgenda})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Place:"}),e.jsx(n,{...c,children:s.nextMeetingPlace})]})]}),e.jsxs(i,{direction:"column",my:"md",children:[e.jsx(n,{...r,mb:"xs",children:"Expense / Claim"}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Name:"}),e.jsx(n,{...c,children:s==null?void 0:s.expenseName})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Type:"}),e.jsx(n,{...c,children:((C=s==null?void 0:s.expenseTypeDetail)==null?void 0:C.name)||"---"})]}),e.jsxs(i,{direction:"row",align:"center",columnGap:"sm",children:[e.jsx(n,{...r,children:"Price:"}),e.jsx(n,{...c,children:d})]})]})]})}))})})]})]})})]}),e.jsx(We,{title:"Add Lead/Project",opened:de,onClose:()=>R(!1),companyId:p._id}),e.jsx(Qe,{title:"Add Contact",opened:oe,companyId:p._id,onClose:()=>O(!1)}),e.jsx(Be,{title:"Add Follow Up",opened:ue,projectId:l._id,companyId:p._id,onClose:()=>W(!1)}),e.jsx(Ve,{title:"Add Claim",opened:xe,companyId:p._id,projectId:l._id,onClose:()=>Y(!1)}),e.jsx($e,{title:"Add Purchase Request",opened:he,companyId:p._id,projectId:l._id,onClose:()=>E(!1)})]})};export{Ue as CompanyProjects,Ue as default};
